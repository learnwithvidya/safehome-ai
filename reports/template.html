<!-- filename: reports/template.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SafeHome-AI Report</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f5f7fb;
      color: #0f172a;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 960px;
      margin: 2rem auto;
      background: #ffffff;
      padding: 1.8rem 2rem;
      border-radius: 18px;
      box-shadow: 0 16px 40px rgba(15, 23, 42, 0.08);
    }
    h1, h2, h3 {
      margin-top: 0;
    }
    .header {
      border-bottom: 1px solid #e5e7eb;
      padding-bottom: 1rem;
      margin-bottom: 1.2rem;
    }
    .badge {
      display: inline-block;
      padding: 0.2rem 0.6rem;
      border-radius: 999px;
      background: #e0f2fe;
      color: #0369a1;
      font-size: 0.8rem;
      margin-right: 0.4rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
      font-size: 0.9rem;
    }
    th, td {
      padding: 0.6rem 0.4rem;
      border-bottom: 1px solid #e5e7eb;
      text-align: left;
    }
    th {
      background: #f3f4ff;
    }
    .risk-low { color: #16a34a; font-weight: 600; }
    .risk-medium { color: #d97706; font-weight: 600; }
    .risk-high { color: #b91c1c; font-weight: 600; }
    .section {
      margin-top: 1.8rem;
    }
    .note {
      font-size: 0.8rem;
      color: #6b7280;
      margin-top: 1rem;
    }
    ul {
      margin: 0.4rem 0 0.4rem 1.2rem;
    }
  </style>
</head>
<body>
<div class="container">
  <div class="header">
    <h1>SafeHome-AI Network Security Report</h1>
    <div>
      <span class="badge">Network: {{ network }}</span>
      <span class="badge">Devices: {{ results|length }}</span>
      <span class="badge">Generated by SafeHome-AI v0.1</span>
    </div>
    <p style="font-size:0.9rem; color:#6b7280; margin-top:0.6rem;">
      This report summarises basic visibility and risk indicators for devices discovered
      in the specified network range. It is intended for awareness, training and initial assessments.
    </p>
  </div>

  <div class="section">
    <h2>Device Summary</h2>
    <table>
      <thead>
      <tr>
        <th>IP Address</th>
        <th>MAC Address</th>
        <th>Vendor</th>
        <th>Open Ports</th>
        <th>Risk Level</th>
      </tr>
      </thead>
      <tbody>
      {% for r in results %}
        {% set risk_label = r.risk.label %}
        {% if risk_label == "High" %}
          {% set risk_class = "risk-high" %}
        {% elif risk_label == "Medium" %}
          {% set risk_class = "risk-medium" %}
        {% else %}
          {% set risk_class = "risk-low" %}
        {% endif %}
        <tr>
          <td>{{ r.ip }}</td>
          <td>{{ r.mac or "-" }}</td>
          <td>{{ r.vendor or "-" }}</td>
          <td>
            {% if r.open_ports %}
              {{ r.open_ports | join(", ") }}
            {% else %}
              -
            {% endif %}
          </td>
          <td class="{{ risk_class }}">{{ risk_label }}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="section">
    <h2>Per-Device Notes</h2>
    {% for r in results %}
      <h3>{{ r.ip }} {% if r.vendor %}â€“ {{ r.vendor }}{% endif %}</h3>
      <p><strong>Open ports:</strong>
        {% if r.open_ports %}
          {{ r.open_ports | join(", ") }}
        {% else %}
          None detected in common set.
        {% endif %}
      </p>
      <p><strong>Risk level:</strong>
        {{ r.risk.label }}
      </p>
      {% if r.risk.reasons %}
        <p><strong>Reasons:</strong></p>
        <ul>
          {% for reason in r.risk.reasons %}
            <li>{{ reason }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endfor %}
  </div>

  <div class="section">
    <h2>General Recommendations</h2>
    <ul>
      <li>Disable unused services and ports on devices wherever possible.</li>
      <li>Change default usernames and passwords on routers, cameras and IoT devices.</li>
      <li>Ensure firmware and software are regularly updated.</li>
      <li>Segment guest / IoT devices into a separate network if your router supports it.</li>
      <li>Repeat scans periodically to detect new devices or configuration drift.</li>
    </ul>
  </div>

  <p class="note">
    SafeHome-AI v0.1 is an educational and awareness-oriented tool and does not replace a full
    professional vulnerability assessment. Use this report as a starting point for improving
    basic security hygiene in your home or lab environment.
  </p>
</div>
</body>
</html>
